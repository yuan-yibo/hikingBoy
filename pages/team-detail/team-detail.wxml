<view class="container">
  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <block wx:else>
    <!-- å›¢é˜Ÿä¿¡æ¯å¡ç‰‡ -->
    <view class="team-header">
      <view class="team-name">{{team.name}}</view>
      <view class="team-desc">{{team.description || 'æš‚æ— æè¿°'}}</view>
      
      <!-- é‚€è¯·ç  -->
      <view class="invite-section">
        <view class="invite-label">é‚€è¯·ç </view>
        <view class="invite-code-wrapper">
          <text class="invite-code">{{team.inviteCode}}</text>
          <button class="btn-copy" bindtap="copyInviteCode">å¤åˆ¶</button>
          <button wx:if="{{isOwner}}" class="btn-refresh" bindtap="regenerateCode">åˆ·æ–°</button>
        </view>
      </view>

      <view class="team-stats">
        <view class="stat-item">
          <text class="stat-value">{{members.length}}</text>
          <text class="stat-label">æˆå‘˜</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{records.length}}</text>
          <text class="stat-label">è®°å½•</text>
        </view>
      </view>
    </view>

    <!-- æ ‡ç­¾æ  -->
    <view class="tab-bar">
      <view 
        class="tab-item {{activeTab === 'records' ? 'active' : ''}}" 
        bindtap="switchTab"
        data-tab="records"
      >
        å¾’æ­¥è®°å½•
      </view>
      <view 
        class="tab-item {{activeTab === 'members' ? 'active' : ''}}" 
        bindtap="switchTab"
        data-tab="members"
      >
        å›¢é˜Ÿæˆå‘˜
      </view>
    </view>

    <!-- å¾’æ­¥è®°å½•åˆ—è¡¨ -->
    <view wx:if="{{activeTab === 'records'}}" class="content-section">
      <view wx:if="{{records.length === 0}}" class="empty-list">
        <text>æš‚æ— è®°å½•</text>
      </view>
      <view wx:else class="record-list">
        <view 
          wx:for="{{records}}" 
          wx:key="id" 
          class="record-card"
          bindtap="goToRecordDetail"
          data-id="{{item.id}}"
        >
          <view class="record-info">
            <view class="record-header">
              <text class="record-mountain">{{item.mountainName}}</text>
              <text class="record-owner">by {{item.ownerName || 'æœªçŸ¥'}}</text>
            </view>
            <view class="record-meta">
              <text>ğŸ“… {{item.date}}</text>
              <text wx:if="{{item.distance}}">ğŸ“ {{item.distance}}km</text>
            </view>
          </view>
          <view class="record-arrow">></view>
        </view>
      </view>
    </view>

    <!-- æˆå‘˜åˆ—è¡¨ -->
    <view wx:if="{{activeTab === 'members'}}" class="content-section">
      <view class="member-list">
        <view wx:for="{{members}}" wx:key="id" class="member-card">
          <view class="member-avatar">
            <image wx:if="{{item.avatar}}" src="{{item.avatar}}" mode="aspectFill"/>
            <text wx:else class="avatar-placeholder">ğŸ‘¤</text>
          </view>
          <view class="member-info">
            <text class="member-name">{{item.nickname || 'æˆå‘˜'}}</text>
            <text class="member-role {{item.role}}">
              {{item.role === 'OWNER' ? 'åˆ›å»ºè€…' : (item.role === 'ADMIN' ? 'ç®¡ç†å‘˜' : 'æˆå‘˜')}}
            </text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-section">
      <button wx:if="{{!isOwner}}" class="btn-leave" bindtap="leaveTeam">é€€å‡ºå›¢é˜Ÿ</button>
      <button wx:if="{{isOwner}}" class="btn-delete" bindtap="deleteTeam">è§£æ•£å›¢é˜Ÿ</button>
    </view>
  </block>
</view>
