<!--pages/stats/stats.wxml-->
<view class="container">
  <!-- å¤´éƒ¨æ€»è§ˆ -->
  <view class="header-overview">
    <view class="overview-title">ğŸ† çˆ¬å±±æˆå°±</view>
    <view class="overview-subtitle">å’Œå®è´ä¸€èµ·å¾æœçš„å±±å³°</view>
  </view>

  <!-- ç»Ÿè®¡å¡ç‰‡ç»„ -->
  <view class="stats-cards">
    <!-- æ€»æ¬¡æ•° -->
    <view class="stat-card primary-card" style="background: linear-gradient(135deg, {{themeColors.primary}} 0%, {{themeColors.primaryLight}} 100%);" bindtap="showAllMountains">
      <view class="stat-icon">ğŸ”ï¸</view>
      <view class="stat-value">{{totalCount}}</view>
      <view class="stat-label">çˆ¬å±±æ¬¡æ•°</view>
      <view class="stat-decoration"></view>
    </view>

    <!-- æ€»ç…§ç‰‡æ•° -->
    <view class="stat-card secondary-card" style="background: linear-gradient(135deg, #FFA07A 0%, #FFB69E 100%);">
      <view class="stat-icon">ğŸ“·</view>
      <view class="stat-value">{{totalPhotos}}</view>
      <view class="stat-label">ç¾å¥½ç¬é—´</view>
      <view class="stat-decoration"></view>
    </view>
  </view>

  <!-- æœ€è¿‘æ´»åŠ¨ -->
  <view class="recent-section" wx:if="{{recentRecords.length > 0}}">
    <view class="section-title">
      <text class="title-icon">â­</text>
      <text class="title-text">æœ€è¿‘çš„å†’é™©</text>
    </view>
    <view class="recent-list">
      <view 
        wx:for="{{recentRecords}}" 
        wx:key="_id" 
        class="recent-item"
        bindtap="goToDetail"
        data-id="{{item._id}}"
      >
        <view class="recent-date">{{item.date}}</view>
        <view class="recent-mountain">{{item.mountainName}}</view>
      </view>
    </view>
  </view>

  <!-- å¤©æ°”ç»Ÿè®¡ -->
  <view class="weather-section" wx:if="{{weatherStats.length > 0}}">
    <view class="section-title">
      <text class="title-icon">ğŸŒ¤ï¸</text>
      <text class="title-text">å¤©æ°”åˆ†å¸ƒ</text>
    </view>
    <view class="weather-chart">
      <view 
        wx:for="{{weatherStats}}" 
        wx:key="weather"
        class="weather-bar-container"
      >
        <view class="weather-label">
          <text class="weather-icon">{{item.icon}}</text>
          <text class="weather-name">{{item.weather}}</text>
        </view>
        <view class="weather-bar-wrapper">
          <view class="weather-bar" style="width: {{item.percentage}}">
            <view class="weather-bar-fill"></view>
          </view>
          <text class="weather-count">{{item.count}}æ¬¡</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æŒ‰æœˆç»Ÿè®¡ -->
  <view class="monthly-section" wx:if="{{monthlyStats.length > 0}}">
    <view class="section-title">
      <text class="title-icon">ğŸ“…</text>
      <text class="title-text">æœˆåº¦ç»Ÿè®¡</text>
    </view>
    <view class="monthly-list">
      <view 
        wx:for="{{monthlyStats}}" 
        wx:key="month"
        class="monthly-item"
      >
        <view class="monthly-header">
          <view class="monthly-month">{{item.displayMonth}}</view>
          <view class="monthly-count">{{item.count}}æ¬¡</view>
        </view>
        <view class="monthly-stats">
          <view class="stat-item">
            <view class="stat-icon">ğŸ“</view>
            <view class="stat-value">{{item.totalDistance}} km</view>
            <view class="stat-label">æ€»é‡Œç¨‹</view>
          </view>
          <view class="stat-item">
            <view class="stat-icon">â±ï¸</view>
            <view class="stat-value">{{item.totalDuration}}</view>
            <view class="stat-label">æ€»æ—¶é•¿</view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ±å¿—è¯è¯­ -->
  <view class="motivation-card" style="background: {{themeColors.cardGradient}};">
    <view class="motivation-icon">ğŸ’ª</view>
    <view class="motivation-text" style="color: {{themeColors.primary}};">{{motivationText}}</view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{totalCount === 0}}">
    <view class="empty-icon">ğŸ”ï¸</view>
    <view class="empty-text">è¿˜æ²¡æœ‰çˆ¬å±±è®°å½•</view>
    <view class="empty-subtext">å¿«å»æ·»åŠ ç¬¬ä¸€æ¬¡çˆ¬å±±å§ï¼</view>
  </view>

  <!-- å±±å³°åˆ—è¡¨å¼¹çª— -->
  <view class="mountain-modal" wx:if="{{showMountainModal}}" bindtap="hideMountainModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <view class="modal-title">ğŸ”ï¸ å¾æœçš„å±±å³°</view>
        <view class="modal-close" bindtap="hideMountainModal">Ã—</view>
      </view>
      <view class="modal-body">
        <view class="mountain-grid">
          <view 
            wx:for="{{mountainList}}" 
            wx:key="name"
            class="mountain-badge"
            bindtap="goToMountainDetail"
            data-name="{{item.name}}"
            style="background: {{item.gradient}};"
          >
            <view class="badge-icon">ğŸ¯</view>
            <view class="badge-name">{{item.name}}</view>
            <view class="badge-count">{{item.count}}æ¬¡</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
